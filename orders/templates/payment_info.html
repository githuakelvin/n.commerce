{% extends 'base.html' %} <!-- If you have a base template -->

{% block title %}Payment Information{% endblock %}

{% block content %}
<div class="container mt-5">
    <div class="row">
        <div class="col-md-6 offset-md-3">
            <div class="card">
                <div class="card-header bg-primary text-white">
                    <h4>Payment Method</h4>
                </div>
                <div class="card-body">
                    <form method="post">
                        {% csrf_token %}

                        <div class="form-group">
                            <label class="font-weight-bold">Select Payment Method</label>
                            {% for method in payment_methods %}
                            <div class="form-check mb-3">
                                <input class="form-check-input" type="radio" name="payment_method"
                                    id="{{ method.value }}" value="{{ method.value }}" required>
                                <label class="form-check-label" for="{{ method.value }}">
                                    {{ method.label }}
                                </label>
                            </div>
                            {% endfor %}
                        </div>

                        <!-- Credit Card Fields (shown when selected) -->
                        <div id="credit-card-fields" class="payment-fields" style="display: none;">
                            <div class="form-group">
                                <label>Card Number</label>
                                <input type="text" class="form-control" name="card_number"
                                    placeholder="1234 5678 9012 3456">
                            </div>
                            <div class="form-row">
                                <div class="form-group col-md-6">
                                    <label>Expiry Date</label>
                                    <input type="text" class="form-control" name="expiry" placeholder="MM/YY">
                                </div>
                                <div class="form-group col-md-6">
                                    <label>CVV</label>
                                    <input type="text" class="form-control" name="cvv" placeholder="123">
                                </div>
                            </div>
                        </div>

                        <!-- M-Pesa Fields -->
                        <div id="mpesa-fields" class="payment-fields" style="display: none;">
                            <div class="form-group">
                                <label>Phone Number</label>
                                <input type="text" class="form-control" name="mpesa_phone"
                                    placeholder="e.g., 254712345678">
                            </div>
                            <p class="text-muted">You'll receive a payment request on your phone</p>
                        </div>

                        <button type="submit" class="btn btn-primary btn-block mt-4">
                            Continue to Review Order
                        </button>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    // Show/hide payment method specific fields
    document.querySelectorAll('input[name="payment_method"]').forEach(radio => {
        radio.addEventListener('change', function () {
            // Hide all fields first
            document.querySelectorAll('.payment-fields').forEach(field => {
                field.style.display = 'none';
            });

            // Show selected payment method's fields
            if (this.value === 'credit_card') {
                document.getElementById('credit-card-fields').style.display = 'block';
            } else if (this.value === 'mpesa') {
                document.getElementById('mpesa-fields').style.display = 'block';
            }
        });
    });
</script>
{% endblock %}